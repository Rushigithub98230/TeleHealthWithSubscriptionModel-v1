2025-07-27 14:42:13.058 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-27 14:42:44.068 +05:30 [ERR] Unhandled exception occurred
System.InvalidOperationException: Stripe secret key is not configured
   at SmartTelehealth.Infrastructure.Services.StripeService..ctor(IConfiguration configuration, ILogger`1 logger) in D:\DayUsers\Rushikesh\Personal\.Net Projects\TeleHealthWithSubscriptionModel\backend\SmartTelehealth.Infrastructure\Services\StripeService.cs:line 25
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method279(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SmartTelehealth.API.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in D:\DayUsers\Rushikesh\Personal\.Net Projects\TeleHealthWithSubscriptionModel\backend\SmartTelehealth.API\GlobalExceptionMiddleware.cs:line 23
2025-07-27 14:51:56.542 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-27 14:51:56.612 +05:30 [INF] Stripe service initialized successfully
2025-07-27 14:51:57.689 +05:30 [INF] Created Stripe customer: cus_SkweCb4dA7LI18 for test@example.com
2025-07-27 14:52:05.744 +05:30 [INF] Stripe service initialized successfully
2025-07-27 14:52:06.194 +05:30 [INF] Created Stripe customer: cus_SkwePO84yvF32Z for test@example.com
2025-07-27 14:52:19.026 +05:30 [INF] Stripe service initialized successfully
2025-07-27 14:52:19.519 +05:30 [INF] Created Stripe product: prod_SkweBcvi6XQWPN - Test Healthcare Plan
2025-07-27 14:52:51.266 +05:30 [INF] Stripe service initialized successfully
2025-07-27 14:52:51.795 +05:30 [INF] Created Stripe price: price_1RpQlrCI7YurXiFNQcn1EfYY for product prod_SkweBcvi6XQWPN - 29.99 usd every 1 month
2025-07-27 14:52:59.771 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:42:03.020 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-27 15:42:06.601 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:42:07.535 +05:30 [INF] Created Stripe customer: cus_SkxSd4929tekXu for test@example.com
2025-07-27 15:43:15.357 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:48:55.031 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:52:47.782 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:52:48.520 +05:30 [INF] Created Stripe customer: cus_SkxdWKaGuvaMQj for test@example.com
2025-07-27 15:52:51.473 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:52:51.911 +05:30 [INF] Created Stripe product: prod_Skxd1o7hE4iS3D - Test Healthcare Plan
2025-07-27 15:52:53.971 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:52:54.400 +05:30 [INF] Created Stripe price: price_1RpRhyCI7YurXiFNNxVCZKrl for product prod_Skxd1o7hE4iS3D - 29.99 usd every 1 month
2025-07-27 15:53:07.729 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:54:44.986 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:59:38.716 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-27 15:59:38.799 +05:30 [INF] Stripe service initialized successfully
2025-07-27 15:59:40.515 +05:30 [INF] Created and attached test payment method pm_1RpRoVCI7YurXiFNE30BLjf9 to customer cus_SkxSd4929tekXu
2025-07-27 16:05:12.357 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:05:13.744 +05:30 [INF] Created and attached test payment method pm_1RpRtsCI7YurXiFNZn9Gz1lf to customer cus_SkxdWKaGuvaMQj
2025-07-27 16:05:28.977 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:05:31.675 +05:30 [INF] Created Stripe subscription: sub_1RpRu9CI7YurXiFN5YaJ5nVt for customer cus_SkxdWKaGuvaMQj
2025-07-27 16:05:36.641 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:05:43.944 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:05:44.561 +05:30 [INF] Paused Stripe subscription: sub_1RpRu9CI7YurXiFN5YaJ5nVt
2025-07-27 16:05:46.886 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:05:47.518 +05:30 [INF] Resumed Stripe subscription: sub_1RpRu9CI7YurXiFN5YaJ5nVt
2025-07-27 16:05:50.371 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:05:50.870 +05:30 [ERR] Stripe error processing payment: The `payment_method` parameter supplied pm_1RpRtsCI7YurXiFNZn9Gz1lf belongs to the Customer cus_SkxdWKaGuvaMQj. Please include the Customer in the `customer` parameter on the PaymentIntent.
Stripe.StripeException: The `payment_method` parameter supplied pm_1RpRtsCI7YurXiFNZn9Gz1lf belongs to the Customer cus_SkxdWKaGuvaMQj. Please include the Customer in the `customer` parameter on the PaymentIntent.
   at Stripe.LiveApiRequestor.ProcessResponse[T](StripeResponse response, ApiMode apiMode) in /_/src/Stripe.net/Infrastructure/Public/LiveApiRequestor.cs:line 245
   at Stripe.LiveApiRequestor.RequestAsync[T](BaseAddress baseAddress, HttpMethod method, String path, BaseOptions options, RequestOptions requestOptions, CancellationToken cancellationToken) in /_/src/Stripe.net/Infrastructure/Public/LiveApiRequestor.cs:line 110
   at Stripe.Service.RequestAsync[T](BaseAddress baseAddress, HttpMethod method, String path, BaseOptions options, RequestOptions requestOptions, CancellationToken cancellationToken) in /_/src/Stripe.net/Services/_base/Service.cs:line 100
   at SmartTelehealth.Infrastructure.Services.StripeService.<>c__DisplayClass18_0.<<ProcessPaymentAsync>b__0>d.MoveNext() in D:\DayUsers\Rushikesh\Personal\.Net Projects\TeleHealthWithSubscriptionModel\backend\SmartTelehealth.Infrastructure\Services\StripeService.cs:line 513
2025-07-27 16:05:56.617 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:05:57.321 +05:30 [INF] Cancelled Stripe subscription: sub_1RpRu9CI7YurXiFN5YaJ5nVt
2025-07-27 16:13:37.467 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-27 16:13:37.664 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:14:12.793 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:14:13.671 +05:30 [INF] Created Stripe customer: cus_SkxyVUNHUVYUBQ for test@example.com
2025-07-27 16:16:57.514 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:16:58.303 +05:30 [ERR] Stripe error processing payment: The `payment_method` parameter supplied pm_1RpRtsCI7YurXiFNZn9Gz1lf belongs to the Customer cus_SkxdWKaGuvaMQj. Please include the Customer in the `customer` parameter on the PaymentIntent.
Stripe.StripeException: The `payment_method` parameter supplied pm_1RpRtsCI7YurXiFNZn9Gz1lf belongs to the Customer cus_SkxdWKaGuvaMQj. Please include the Customer in the `customer` parameter on the PaymentIntent.
   at Stripe.LiveApiRequestor.ProcessResponse[T](StripeResponse response, ApiMode apiMode) in /_/src/Stripe.net/Infrastructure/Public/LiveApiRequestor.cs:line 245
   at Stripe.LiveApiRequestor.RequestAsync[T](BaseAddress baseAddress, HttpMethod method, String path, BaseOptions options, RequestOptions requestOptions, CancellationToken cancellationToken) in /_/src/Stripe.net/Infrastructure/Public/LiveApiRequestor.cs:line 110
   at Stripe.Service.RequestAsync[T](BaseAddress baseAddress, HttpMethod method, String path, BaseOptions options, RequestOptions requestOptions, CancellationToken cancellationToken) in /_/src/Stripe.net/Services/_base/Service.cs:line 100
   at SmartTelehealth.Infrastructure.Services.StripeService.<>c__DisplayClass18_0.<<ProcessPaymentAsync>b__0>d.MoveNext() in D:\DayUsers\Rushikesh\Personal\.Net Projects\TeleHealthWithSubscriptionModel\backend\SmartTelehealth.Infrastructure\Services\StripeService.cs:line 513
2025-07-27 16:17:14.297 +05:30 [INF] Stripe service initialized successfully
2025-07-27 16:17:14.733 +05:30 [INF] Created Stripe customer: cus_Sky18w771K1jdU for test@example.com
2025-07-27 16:20:58.746 +05:30 [INF] Stripe service initialized successfully
